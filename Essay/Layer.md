## 레이어
- DDD에서 레이어드 아키텍처는 Database, Persistence, Business, Presentation 레이어로 보통 나뉜다.

### 도메인의 특징
- 도메인이란 어떠한 문제를 해결하기 위해서 프로그래밍을 통해서 해결 방법을 제공하는 기능들을 서술하기 위한 것이다.
- 웹 시스템을 예로 들면 웹은 브라우저에 표현되는 유저 인터페이스를 통해서 유저가 조작한 정보를 저장해야 한다. 하지만 데이터베이스는 유저가 다룰 수 있는 대상이 아니고 보안 문제가 있기 때문에 중간에 서버 애플리케이션이라는 것을 두어 유저 인터페이스와 데이터베이스 간의 매끄러운 연결을 해 준다.
- 이 때 데이터를 데이터를 누가, 언제, 어디서, 어떻게, 무엇을, 왜 저장하는 것인지에 대한 로직을 애플리케이션 레벨에서 정할 수 있다. 이 로직이 바로 도메인에 해당한다.

### Persistence 레이어의 필요성
- 어떤 시스템을 설계하는데 있어서 애플리케이션의 상태를 변화를 저장하는 Database는 필수적이다. 하지만 데이터베이스는 쿼리 기반의 언어로 만들어져 있기 때문에 서버에서 데이터베이스의 데이터를 가져오기 위해서는 쿼리를 사용해야 한다. 쿼리 기반의 언어는 도메인 지식을 서술하는데 좋지는 않은데, 그 이유는 데이터에 테이블과 컬럼으로 이름이 붙여져 있을 뿐, 데이터를 누가, 언제, 어디서, 어떻게, 무엇을, 왜 뽑아야 하는지는 기술하기 않기 때문이다. 물론 데이터베이스의 테이블명과 컬럼 그리고 관계도를 보고 대략의 쓰임새를 유추할 수는 있지만, 웹 시스템이 제공하는 다양한 상호작용을 담아내지는 못한다. 곧 도메인을 기술하는데 불완전하기 때문에 유저와의 소통을 위한 중간의 애플리케이션을 요구한다. 애플리케이션에서 데이터베이스와의 소통을 위해 쿼리를 사용하는 것이 Persistence 레이어의 필요성이다.

### 레이어드 아키텍처를 사용하는 목적

### 라라벨에서의 Persistence 레이어
- 라라벨의 모델을 이용해서 리포지토리 패턴의 클래스를 만드는 것이라면 모델은 Persistence 레이어에 해당한다. 그러나 eloquent로 사양패턴을 만드는 경우, 엘로퀀트 모델 내부는 쿼리 빌더로 구성이 되기 때문에 Persistence 레이어의 역할을 하지만, 엘로퀀트 외부로 표현되는 사양 패턴을 구현한 메소드는 도메인 로직을 나타내기 때문에 Business 레이어에 해당한다.
- 엘로퀀트 모델은 하나의 테이블에 대한 비즈니스 로직을 매핑한다. 많은 경우, 하나의 모델에 다른 모델을 참조하는 코드를 만들어 내는데, 프로그래머는 파일 및 폴더의 분리를 통해서 도메인의 경계를 어느 정도 분리하는 방법을 사용하는데 모델이 모델을 참조하게 되면서 도메인의 경계를 명확하게 나눌 수 없는 문제점이 발생하게 된다. 따라서 각 모델이 담당하는 영역이 아닌 다른 모델의 데이터를 혼합할 때는 서비스 클래스를 만들어 서로 다른 모델의 데이터를 조합하는 로직을 만드는 편이 좋다.
- 엘로퀀트 모델을 모아 놓은 폴더와 서비스 클래스를 모아 놓은 폴더는 서로 다르지만 레이어드 아키텍처의 계층적으로 보면 동일한 Business 레이어에 해당한다.
