## 트렌젝션이란?
- 데이터베이스 변경 시도 중 오류가 발생 했을 때 시도한 변경을 모두 무효화 하여 어떤 시도도 데이터베이스에 영향을 주지 않게 하는 도구

## 상태를 저장하지 않는 PHP
- PHP는 상태를 저장하지 않는 특성을 가지고 있기 때문에 상태를 저장할 수 있는 방법을 마련 해 줘야 한다. 상태 저장을 위해 사용할 수 있는 방법은 데이터베이스를 통해 상태를 저장하는 방식이다.

## 원자성 (Atomicity)
- 데이터베이스의 무결성을 위해 어떤 트렌젝션의 실행은 트렌젝션 대상이 되는 모든 대상의 성공을 통해서만 데이터베이스의 상태를 변경하고 실패하면 데이터베이스의 상태를 변경하지 않음으로서 예측하지 못한 변경으로 데이터베이스 상태가 변하는 것을 막기 위한 방법이다. 
- 트렌젝션 단위의 모든 작업은 모두 성공하거나 모두 실패하는 개념으로서 이 단위를 원자성이라고 한다. 작업의 성공 실패가 쪼개져서 어떤 건 되고 어떤 건 되지 않는 방식이 아니므로 원자성이라고 불린다.

## 일관성 (Consistency)
- 도메인 모델 내에서 실행되는 작업과 코드에는 일관성이 있어야 한다.
- 도메인 모델의 프로세스를 코드의 플로우와 가능한한 매칭되도록 만든다.
- 데이터베이스는 애플리케이션이 사용하기 쉬운 방향으로 모델링 되어야 한다.

### 상태
- 상태가 없는 PHP를 마치 상태가 있는 것처럼 표현하는 것이 일관성 있는 프로그래밍 방법이다.

### 애플리케이션 수준의 트랜잭션
- 데이터베이스의 일관성뿐만 아니라 애플리케이션 수준에서 핵심 기능, 논리, 프로세스 등의 일관성이 중요하다.

## 격리(Isolation)
- 사람이 물컵에 들어 있는 물을 마신다고 하자. 물이 물컵에서 사람의 입안으로 들어가는 과정일 뿐이지만 사람과 물컵의 관점에서 보면 사람의 입으로 물이 들어가고 물컵의 물이 사라진다. 단순한 물의 이동일 뿐이지만 객체의 설정에 따라 한 쪽에서는 사라지고 다른 한 쪽에서는 증가하는 로직을 가진다. 물컵에서 물이 사라지고 사람의 입 안으로 물이 들어가는 것은 함께 이뤄지는 작업으로 서로 따로 분리될 수 있는 작업이 아니다.
- 한 계좌에서 다른 계좌로 돈이 이동하는 것도 마찬가지이다. 한 계좌에서 돈이 빠지고 빠진 액수 만큼 다른 계좌에는 돈이 늘어나야 한다. 이것은 분리되지 않고 함께 일어나야 하는 작업이다. 격리는 함께 이뤄져야 하는 작업을 다른 맥락과 분리하여 함께 이뤄지는 작업 전체가 올바르게 완료되도록 분리한 것을 의미한다.
- 만약 사람 입으로 물이 들어갔는데 물컵에는 원래 물이 없는 경우라고 생각해 보자. 실제로는 일어날 수 없는 일이지만 사람 입으로 물이 들어간 논리와 물컵에서 물이 빠져 나오는 논리로 구성된 프로그래밍에서는 존재하는 상황이다.
- 이런 문제는 데이터베이스 트렌젝션을 통해서 해결할 수 있으며 함께 이뤄지지 않으면 적용하지 않는 방식을 통해서 구현될 수 있다.

### 트렌젝션의 단점
- 트렌젝션 단위 내의 쿼리를 여럿 보낼 때, 시스템의 속도를 지연시키거나 락(lock) 문제를 일으킬 수 있기 때문에 과도하게 사용해서는 안 된다. 필요할 때 적절하게 사용하도록 하자.

## 내구성 (Durability)
- 데이터가 정전 및 시스템 충돌로부터 보호될 수 있는 능력이 내구성이다.
- 내구성을 가지게 하기 위해서는 트랜젝션을 사용하는 방법도 있지만, 데이터를 중복하여 하나의 데이터가 손상 되었을 때 손상 되지 않은 다른 데이터를 통해 원본 데이터를 복구하는 방식으로 내구성을 구현할 수 있다.
